# ğŸ¦Š Investment Analytics Platform

> A full-stack financial analysis platform for stock research and portfolio optimization, built as a capstone project for UNFC.

[![Frontend](https://img.shields.io/badge/Frontend-Vercel-black?logo=vercel)](https://capstone-project-unfc-ashen.vercel.app)
[![Backend](https://img.shields.io/badge/Backend-Render-46E3B7?logo=render)](https://capstone-project-unfc-l68p.onrender.com)
[![Database](https://img.shields.io/badge/Database-Supabase-3ECF8E?logo=supabase)](https://supabase.com)

---

## ğŸ“Œ Purpose

This platform gives investors and analysts a web-based toolkit to:

- **Analyze individual stocks** â€” view historical price charts (weekly or monthly aggregation), key risk/return statistics, and generate price forecasts using multiple machine learning models.
- **Build & optimize portfolios** â€” select multiple assets, run PyPortfolioOpt to find optimal allocation weights, and inspect individual asset statistics, correlations, covariances, and beta values.

The project demonstrates a production-grade architecture integrating a Python data science backend with a modern React frontend, backed by a managed PostgreSQL database.

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Vercel           â”‚        â”‚       Render           â”‚        â”‚      Supabase         â”‚
â”‚  (Next.js Frontend)  â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  (FastAPI Backend)     â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  (PostgreSQL DB)      â”‚
â”‚                      â”‚  HTTP  â”‚                       â”‚  SDK   â”‚                      â”‚
â”‚  React 19 + shadcn   â”‚        â”‚  Python 3.12          â”‚        â”‚  assets table         â”‚
â”‚  Recharts + Tailwind â”‚        â”‚  PyPortfolioOpt        â”‚        â”‚  historical_prices    â”‚
â”‚  App Router          â”‚        â”‚  yfinance + Prophet   â”‚        â”‚  Row Level Security   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Request flow:**
1. User's browser â†’ Vercel (static Next.js app)
2. Frontend calls `NEXT_PUBLIC_API_URL` (Render FastAPI)
3. Backend queries Supabase for stored price history or fetches live data from Yahoo Finance
4. Results returned to frontend for visualization

---

## âœ¨ Features

### ğŸ“ˆ Stock Viewer (`/stock`)
- Asset picker populated from the Supabase `assets` table
- Fetch & sync new tickers directly from Yahoo Finance (via the backend)
- Interactive candlestick/line chart â€” **Weekly** or **Monthly** view (monthly = frontend-aggregated mean of weekly closes)
- User-selectable date range (default: last 1 year)
- Forecast generation with model selector:
  - **Base (EWM)** â€” Exponentially Weighted Mean
  - **Prophet** â€” Facebook Prophet time series
  - **LSTM** â€” Long Short-Term Memory neural network
- Full statistics panel (sourced from `/api/v1/portfolio/stats`):
  - Avg Return, Variance, Std Deviation
  - Cumulative Return, Annualized Volatility, Sharpe Score
  - Max Drawdown, Skewness, Kurtosis
  - Returns Summary: Min / Max / Mean

### ğŸ’¼ Portfolio Builder (`/portfolio`)
- Multi-asset selector (min 2, max 10 assets)
- Date range selector (default: last 3 years)
- Optimization objectives:
  - Maximize Sharpe Ratio
  - Minimize Volatility
  - Target Return (with valid-range hints derived from live stats)
  - Target Volatility (with valid-range hints derived from live stats)
- Results:
  - Donut chart with percentage weight per asset
  - Individual asset stats cards
  - Correlation Matrix
  - Covariance Matrix
  - Beta vs Equal-Weighted portfolio

### ğŸ  Homepage
- Animated blob background (4 brand-color blobs with independent drift loops)
- Interactive canvas mouse-trail: circles & stars in brand colors follow the cursor
- Mascot hero layout

---

## ğŸ—„ï¸ Database Schema (Supabase)

### `assets`
| Column | Type | Description |
|---|---|---|
| `id` | UUID (PK) | Auto-generated |
| `symbol` | TEXT (UNIQUE) | Ticker symbol, e.g. `AAPL`, `BTC-USD` |
| `name` | TEXT | Full company/asset name |
| `asset_type` | TEXT | `stock`, `crypto`, or `index` |
| `currency` | TEXT | Default `USD` |
| `last_updated` | TIMESTAMPTZ | Last sync from Yahoo Finance |
| `created_at` | TIMESTAMPTZ | Row creation timestamp |

### `historical_prices`
| Column | Type | Description |
|---|---|---|
| `id` | UUID (PK) | Auto-generated |
| `asset_id` | UUID (FK â†’ assets) | Links to the asset |
| `timestamp` | TIMESTAMPTZ | Week-start date (weekly cadence) |
| `open_price` | DECIMAL | Opening price |
| `high_price` | DECIMAL | Weekly high |
| `low_price` | DECIMAL | Weekly low |
| `close_price` | DECIMAL | Closing price (required) |
| `volume` | BIGINT | Trade volume |

> All data is stored at **weekly** granularity. Monthly views are aggregated on the frontend.

---

## ğŸ”Œ API Reference (Backend)

Base URL: `https://capstone-project-unfc-l68p.onrender.com`

| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/` | Health check |
| `GET` | `/api/v1/assets` | List all tracked assets |
| `GET` | `/api/v1/prices/{symbol}` | Get historical prices for a symbol |
| `POST` | `/api/v1/prices/sync` | Fetch & store prices from Yahoo Finance |
| `POST` | `/api/v1/forecast` | Generate a price forecast |
| `POST` | `/api/v1/portfolio/stats` | Get statistics for a list of symbols |
| `POST` | `/api/v1/portfolio/optimize` | Run portfolio optimization |
| `POST` | `/api/v1/analyze` | Analyze a single asset |

Full interactive docs available at: `{BASE_URL}/docs` (Swagger UI)

---

## ğŸ› ï¸ Tech Stack

| Layer | Technology | Version |
|---|---|---|
| **Frontend Framework** | Next.js (App Router) | 16.1.6 |
| **UI Library** | React | 19.2.3 |
| **Components** | shadcn/ui + Radix UI | latest |
| **Styling** | Tailwind CSS | 3.4.x |
| **Charts** | Recharts | 2.15.x |
| **Forms** | React Hook Form + Zod | 7.x / 4.x |
| **Icons** | Lucide React | 0.575.x |
| **Backend Framework** | FastAPI | â‰¥0.110 |
| **Python** | Python | 3.12 |
| **Data Source** | yfinance | â‰¥0.2.36 |
| **Portfolio Optimization** | PyPortfolioOpt | â‰¥1.5.6 |
| **ML / Forecasting** | scikit-learn, Prophet, (LSTM) | latest |
| **Database** | Supabase (PostgreSQL) | managed |
| **ORM / Client** | supabase-py | â‰¥2.4 |

---

## ğŸš€ Local Development

### Prerequisites
- Python 3.12+
- Node.js 20+
- A Supabase project (free tier is fine)

### 1. Clone the repo

```bash
git clone https://github.com/YOUR_USERNAME/capstone_project_unfc.git
cd capstone_project_unfc
```

### 2. Backend setup

```bash
cd backend
python -m venv .venv
.venv\Scripts\activate          # Windows
# source .venv/bin/activate     # macOS/Linux
pip install -r requirements.txt
```

Create `backend/.env`:
```env
SUPABASE_URL=https://YOUR_PROJECT_ID.supabase.co
SUPABASE_KEY=your-anon-key
FRONTEND_URL=http://localhost:3000
```

Start the API:
```bash
uvicorn app.main:app --reload --port 8000
```

API will be at `http://localhost:8000` â€” Swagger UI at `http://localhost:8000/docs`.

### 3. Frontend setup

```bash
cd frontend
npm install
```

Create `frontend/.env.local`:
```env
NEXT_PUBLIC_API_URL=http://localhost:8000
```

Start the dev server:
```bash
npm run dev
```

App will be at `http://localhost:3000`.

### 4. Seed the database (optional)

```bash
cd backend
python scripts/seed_data.py
```

This populates the `assets` table with a default list of tickers and fetches their historical prices into Supabase.

---

## â˜ï¸ Production Deployment

### Step 1 â€” Supabase

1. Go to [supabase.com](https://supabase.com) â†’ **New Project**
2. Once provisioned, open **SQL Editor** and run the migrations in order:
   - `supabase/migrations/20260202192900_init_schema.sql`
   - `supabase/migrations/20260211221317_predictions.sql`
3. Note your **Project URL** and **anon key** from **Settings â†’ API**
4. Verify **Row Level Security** policies are active on `assets` and `historical_prices`

### Step 2 â€” Backend on Render

1. Go to [render.com](https://render.com) â†’ **New â†’ Web Service**
2. Connect your GitHub repo
3. Settings:

| Setting | Value |
|---|---|
| Root Directory | *(leave empty)* |
| Runtime | Python 3 |
| Build Command | `pip install -r backend/requirements.txt` |
| Start Command | `uvicorn backend.app.main:app --host 0.0.0.0 --port $PORT` |

4. Add environment variables:

| Variable | Value |
|---|---|
| `SUPABASE_URL` | `https://YOUR_PROJECT_ID.supabase.co` |
| `SUPABASE_KEY` | your anon key |
| `FRONTEND_URL` | your Vercel URL (add after Step 3) |
| `PYTHON_VERSION` | `3.12.0` |

5. Copy the Render service URL for the next step.

### Step 3 â€” Frontend on Vercel

1. Go to [vercel.com](https://vercel.com) â†’ **Add New Project**
2. Import the GitHub repo
3. Settings:

| Setting | Value |
|---|---|
| Framework Preset | Next.js |
| Root Directory | `frontend` |
| Build Command | `npm run build` |
| Output Directory | `.next` |

4. Add environment variable:

| Variable | Value | Environment |
|---|---|---|
| `NEXT_PUBLIC_API_URL` | `https://your-service.onrender.com` | Production |

5. Deploy. Once live, copy the Vercel URL back into Render's `FRONTEND_URL` variable and redeploy the backend.

---

## ğŸ”’ Environment Variables Reference

### Backend (`backend/.env`)
```env
SUPABASE_URL=          # Supabase project URL
SUPABASE_KEY=          # Supabase anon key (or service role for writes)
FRONTEND_URL=          # Allowed CORS origin (Vercel URL in prod)
```

### Frontend (`frontend/.env.local`)
```env
NEXT_PUBLIC_API_URL=   # FastAPI base URL (Render URL in prod)
```

---

## ğŸ“ Project Structure

```
capstone_project_unfc/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/                    # FastAPI application
â”‚   â”‚   â”œâ”€â”€ api/v1/endpoints/   # Route handlers (assets, prices, forecast, portfolioâ€¦)
â”‚   â”‚   â””â”€â”€ main.py
â”‚   â”œâ”€â”€ analytics/
â”‚   â”‚   â”œâ”€â”€ forecasting/        # EWM, Prophet, LSTM models
â”‚   â”‚   â””â”€â”€ optimization/       # PyPortfolioOpt wrappers, risk metrics
â”‚   â”œâ”€â”€ core/                   # Config, database client
â”‚   â”œâ”€â”€ data_engine/            # Yahoo Finance fetcher & sync coordinator
â”‚   â”œâ”€â”€ schemas/                # Pydantic request/response models
â”‚   â”œâ”€â”€ scripts/seed_data.py    # Database seeder
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ supabase/
â”‚       â””â”€â”€ migrations/         # SQL migration files
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ app/
â”‚       â”‚   â”œâ”€â”€ page.tsx        # Homepage (animated background + mascot)
â”‚       â”‚   â”œâ”€â”€ stock/          # Stock Viewer page + components
â”‚       â”‚   â””â”€â”€ portfolio/      # Portfolio Builder page + components
â”‚       â””â”€â”€ components/
â”‚           â”œâ”€â”€ ui/             # shadcn/ui primitives
â”‚           â”œâ”€â”€ MouseTrail.tsx  # Canvas mouse-trail animation
â”‚           â””â”€â”€ LocalEnvBanner.tsx
â””â”€â”€ docs/                       # Architecture & phase documentation
```

---

## ğŸ¨ Brand Colors

| Name | Hex | Usage |
|---|---|---|
| Cerulean Blue | `#0487D9` | Primary â€” buttons, links, charts |
| Amber Orange | `#F27405` | Secondary â€” Portfolio Builder accents |
| Flame Red | `#F23005` | Accent â€” highlights |
| Crimson | `#A60303` | Destructive / danger |
| Near Black | `#0D0D0D` | Foreground / text |

---

## ğŸ“„ License

This project was developed as a capstone for **UNFC**. All rights reserved.
